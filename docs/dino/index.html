<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vihaan Runner - Level 1</title>
  <style>
    :root {
      --bg0: #070b16;
      --bg1: #111a33;
      --ink: #dbe9ff;
      --accent: #4fc3ff;
      --accent2: #8a7dff;
      --danger: #ff5d7a;
      --ok: #39d98a;
      --ground: #1b2447;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      font-family: "JetBrains Mono", "Fira Code", monospace;
      color: var(--ink);
      background: radial-gradient(1200px 500px at 50% -20%, #1d2b52 0%, var(--bg0) 60%), var(--bg0);
      padding: 24px;
    }

    .wrap {
      width: min(980px, 96vw);
    }

    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .title {
      font-weight: 700;
      letter-spacing: 0.2px;
      font-size: clamp(16px, 2.3vw, 22px);
      color: #f4f7ff;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid #273463;
      background: rgba(14, 22, 46, 0.86);
      color: #c9d7ff;
      font-size: 12px;
    }

    .board {
      border-radius: 16px;
      border: 1px solid #2a3668;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(15, 25, 52, 0.96), rgba(8, 12, 26, 0.96));
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45), inset 0 1px 0 rgba(255, 255, 255, 0.07);
    }

    canvas {
      width: 100%;
      height: auto;
      display: block;
      image-rendering: pixelated;
    }

    .hud {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 12px;
      color: #afc2ff;
      font-size: 12px;
    }

    .kbd {
      border: 1px solid #33457f;
      border-bottom-width: 2px;
      background: #121b3a;
      border-radius: 6px;
      padding: 1px 7px;
      color: #dce8ff;
      font-size: 11px;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="title">Vihaan Runner: Deepfake Lab Escape (Level 1)</div>
      <div class="pill">Goal: survive to <strong>600</strong> score</div>
    </div>

    <div class="board">
      <canvas id="game" width="960" height="320" aria-label="Dino runner game" role="img"></canvas>
    </div>

    <div class="hud">
      <div>Jump: <span class="kbd">Space</span> / <span class="kbd">â†‘</span> / Tap</div>
      <div>Restart: <span class="kbd">R</span></div>
      <div><a href="https://github.com/Vihaan-Singhal1/Vihaan-Singhal1" aria-label="Back to GitHub profile repository">Back to profile repo</a></div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const W = canvas.width;
    const H = canvas.height;
    const groundY = H - 62;

    const state = {
      mode: "idle", // idle | running | gameover | cleared
      score: 0,
      best: Number(localStorage.getItem("vihaan_runner_best") || 0),
      speed: 6,
      spawnTimer: 0,
      elapsed: 0,
      stars: [],
      ridges: [],
      clouds: [],
      obstacles: [],
    };

    const dino = {
      x: 86,
      y: groundY - 44,
      w: 38,
      h: 44,
      vy: 0,
      onGround: true,
      jumpForce: 16,
      gravity: 0.9,
      squintTimer: 0,
    };

    for (let i = 0; i < 70; i++) {
      state.stars.push({ x: Math.random() * W, y: Math.random() * (H * 0.55), r: Math.random() * 1.5 + 0.2 });
    }

    for (let i = 0; i < 9; i++) {
      state.ridges.push({ x: i * 130, h: 20 + Math.random() * 50 });
    }

    for (let i = 0; i < 4; i++) {
      state.clouds.push({ x: i * 260 + 80, y: 35 + Math.random() * 70, s: 0.5 + Math.random() * 0.6 });
    }

    function resetGame(mode = "idle") {
      state.mode = mode;
      state.score = 0;
      state.speed = 6;
      state.spawnTimer = 0;
      state.elapsed = 0;
      state.obstacles = [];
      dino.y = groundY - dino.h;
      dino.vy = 0;
      dino.onGround = true;
      dino.squintTimer = 0;
    }

    function jump() {
      if (state.mode === "idle") {
        state.mode = "running";
      }

      if (state.mode === "gameover" || state.mode === "cleared") {
        resetGame("running");
      }

      if (state.mode === "running" && dino.onGround) {
        dino.vy = -dino.jumpForce;
        dino.onGround = false;
      }
    }

    function spawnObstacle() {
      const tall = Math.random() > 0.58;
      const width = tall ? 24 : 20;
      const height = tall ? 58 : 40;
      const y = groundY - height;
      state.obstacles.push({ x: W + 26, y, w: width, h: height, glow: tall ? "#8a7dff" : "#4fc3ff" });
    }

    function intersects(a, b) {
      return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
    }

    function update(dt) {
      const step = dt / 16.6667;
      state.elapsed += dt;

      state.clouds.forEach((c) => {
        c.x -= 0.17 * c.s * step;
        if (c.x < -120) c.x = W + 40;
      });

      state.ridges.forEach((r) => {
        r.x -= 0.6 * step;
        if (r.x < -150) {
          r.x = W + Math.random() * 100;
          r.h = 20 + Math.random() * 50;
        }
      });

      if (state.mode !== "running") return;

      state.score += 0.36 * step;
      state.speed = Math.min(13.2, 6 + state.score * 0.011);
      state.spawnTimer -= dt;

      if (state.spawnTimer <= 0) {
        spawnObstacle();
        const maxGap = Math.max(560, 860 - state.speed * 22);
        const minGap = Math.max(280, 460 - state.speed * 15);
        state.spawnTimer = minGap + Math.random() * (maxGap - minGap);
      }

      dino.vy += dino.gravity * step;
      dino.y += dino.vy * step;

      if (dino.y >= groundY - dino.h) {
        dino.y = groundY - dino.h;
        dino.vy = 0;
        dino.onGround = true;
      }

      state.obstacles.forEach((o) => {
        o.x -= state.speed * step;
      });

      state.obstacles = state.obstacles.filter((o) => o.x + o.w > -12);

      const hitbox = {
        x: dino.x + 5,
        y: dino.y + 5,
        w: dino.w - 10,
        h: dino.h - 6,
      };

      for (const o of state.obstacles) {
        const obstacleBox = {
          x: o.x + 3,
          y: o.y + 2,
          w: o.w - 6,
          h: o.h - 3,
        };

        if (intersects(hitbox, obstacleBox)) {
          state.mode = "gameover";
          dino.squintTimer = 36;
          state.best = Math.max(state.best, Math.floor(state.score));
          localStorage.setItem("vihaan_runner_best", String(state.best));
          break;
        }
      }

      if (state.score >= 600) {
        state.mode = "cleared";
        state.best = Math.max(state.best, Math.floor(state.score));
        localStorage.setItem("vihaan_runner_best", String(state.best));
      }

      if (dino.squintTimer > 0) dino.squintTimer -= 1;
    }

    function drawBackground() {
      const grad = ctx.createLinearGradient(0, 0, 0, H);
      grad.addColorStop(0, "#0a1230");
      grad.addColorStop(1, "#131f45");
      ctx.fillStyle = grad;
      ctx.fillRect(0, 0, W, H);

      ctx.fillStyle = "#f2f4ff";
      ctx.globalAlpha = 0.8;
      ctx.beginPath();
      ctx.arc(W - 100, 52, 22, 0, Math.PI * 2);
      ctx.fill();
      ctx.globalAlpha = 1;

      state.stars.forEach((s, i) => {
        ctx.globalAlpha = 0.35 + Math.sin((state.elapsed / 300) + i) * 0.25;
        ctx.fillStyle = "#dbe8ff";
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
      });
      ctx.globalAlpha = 1;

      state.clouds.forEach((c) => {
        ctx.fillStyle = "rgba(173, 198, 255, 0.18)";
        ctx.beginPath();
        ctx.ellipse(c.x, c.y, 34 * c.s, 14 * c.s, 0, 0, Math.PI * 2);
        ctx.ellipse(c.x + 22 * c.s, c.y + 1, 26 * c.s, 12 * c.s, 0, 0, Math.PI * 2);
        ctx.ellipse(c.x - 20 * c.s, c.y + 3, 22 * c.s, 10 * c.s, 0, 0, Math.PI * 2);
        ctx.fill();
      });

      state.ridges.forEach((r) => {
        ctx.fillStyle = "rgba(80, 120, 220, 0.25)";
        ctx.beginPath();
        ctx.moveTo(r.x, groundY);
        ctx.lineTo(r.x + 80, groundY - r.h);
        ctx.lineTo(r.x + 160, groundY);
        ctx.closePath();
        ctx.fill();
      });

      ctx.fillStyle = "#161f44";
      ctx.fillRect(0, groundY, W, H - groundY);

      ctx.strokeStyle = "#2b3d78";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(0, groundY + 1);
      ctx.lineTo(W, groundY + 1);
      ctx.stroke();

      ctx.strokeStyle = "#243464";
      for (let x = -((state.elapsed * 0.18) % 44); x < W; x += 44) {
        ctx.beginPath();
        ctx.moveTo(x, groundY + 20);
        ctx.lineTo(x + 18, groundY + 20);
        ctx.stroke();
      }
    }

    function drawDino() {
      ctx.save();
      ctx.translate(dino.x, dino.y);

      ctx.fillStyle = "#56c3ff";
      ctx.fillRect(0, 12, 34, 28);
      ctx.fillRect(18, 0, 20, 18);
      ctx.fillRect(6, 38, 8, 6);
      ctx.fillRect(22, 38, 8, 6);

      ctx.fillStyle = "#0e1735";
      const blink = dino.squintTimer > 0 || Math.sin(state.elapsed / 160) > 0.95;
      if (blink) {
        ctx.fillRect(28, 7, 5, 2);
      } else {
        ctx.fillRect(28, 6, 5, 5);
      }

      ctx.fillStyle = "#3f7df7";
      ctx.fillRect(10, 21, 14, 6);

      ctx.restore();
    }

    function drawObstacles() {
      state.obstacles.forEach((o) => {
        ctx.fillStyle = o.glow;
        ctx.fillRect(o.x, o.y, o.w, o.h);
        ctx.fillStyle = "rgba(9, 16, 35, 0.7)";
        ctx.fillRect(o.x + 4, o.y + 8, o.w - 8, o.h - 12);
      });
    }

    function drawHUD() {
      const score = Math.floor(state.score).toString().padStart(3, "0");

      ctx.fillStyle = "rgba(9, 14, 32, 0.74)";
      ctx.fillRect(14, 12, 240, 34);
      ctx.strokeStyle = "#2c3d72";
      ctx.strokeRect(14, 12, 240, 34);

      ctx.fillStyle = "#d9e6ff";
      ctx.font = "15px JetBrains Mono, monospace";
      ctx.fillText(`SCORE ${score}`, 26, 34);
      ctx.fillText(`BEST ${String(state.best).padStart(3, "0")}`, 135, 34);

      if (state.mode === "idle") {
        drawOverlay("Press SPACE to Start", "Level 1: survive to score 600");
      }

      if (state.mode === "gameover") {
        drawOverlay("Signal Lost", "Press R or SPACE to retry");
      }

      if (state.mode === "cleared") {
        drawOverlay("Level Cleared", "Strong run. Press R for another run");
      }
    }

    function drawOverlay(title, subtitle) {
      const w = 420;
      const h = 90;
      const x = W / 2 - w / 2;
      const y = H / 2 - h / 2 - 14;

      ctx.fillStyle = "rgba(8, 12, 28, 0.82)";
      ctx.fillRect(x, y, w, h);
      ctx.strokeStyle = "#33467f";
      ctx.strokeRect(x, y, w, h);

      ctx.fillStyle = "#f2f6ff";
      ctx.font = "700 24px JetBrains Mono, monospace";
      ctx.textAlign = "center";
      ctx.fillText(title, W / 2, y + 36);
      ctx.font = "14px JetBrains Mono, monospace";
      ctx.fillStyle = "#a9bfff";
      ctx.fillText(subtitle, W / 2, y + 62);
      ctx.textAlign = "start";
    }

    let last = performance.now();
    function loop(now) {
      const dt = Math.min(32, now - last);
      last = now;

      update(dt);
      drawBackground();
      drawObstacles();
      drawDino();
      drawHUD();

      requestAnimationFrame(loop);
    }

    window.addEventListener("keydown", (e) => {
      if (e.code === "Space" || e.code === "ArrowUp") {
        e.preventDefault();
        jump();
      }
      if (e.key.toLowerCase() === "r") {
        resetGame("running");
      }
    });

    canvas.addEventListener("pointerdown", () => jump());

    resetGame("idle");
    requestAnimationFrame(loop);
  </script>
</body>
</html>
